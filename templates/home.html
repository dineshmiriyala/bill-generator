{% extends 'base.html' %}
{% set hide_navbar = True %}

{% block content %}

<style>
  /* Cloud Upload Button - small circular Apple-style icon button */
  #cloudUploadBtn {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    font-size: 24px;
    line-height: 1;
    padding: 0;
    background: linear-gradient(135deg, #a3bffa, #6c8edb);
    color: white;
    box-shadow: 0 0 8px rgba(108, 142, 219, 0.6);
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: box-shadow 0.3s ease, transform 0.3s ease;
  }
  #cloudUploadBtn:hover,
  #cloudUploadBtn:focus {
    box-shadow: 0 0 15px rgba(108, 142, 219, 0.9);
    transform: scale(1.1);
    outline: none;
  }

  /* Main buttons two-column grid */
  .main-buttons {
    max-width: 600px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem 1.5rem;
  }

  /* Keep existing Apple-style button aesthetics for main buttons */
  .btn-dark.btn-lg {
    width: 100%;
    padding: 1.1rem 1.8rem;
    border-radius: 12px;
    font-size: 1.2rem;
    font-weight: 550;
    letter-spacing: 0.4px;
    transition: all 0.3s ease-in-out;
    box-shadow: 0 5px 14px rgba(0, 0, 0, 0.25);
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }
  .btn-dark.btn-lg:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 18px rgba(108, 142, 219, 0.5);
  }

  /* Enhanced circular progress indicator for modal */
  .progress-circle {
    position: relative;
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: conic-gradient(#6c8edb 0deg, #cfd8dc 0deg);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1rem auto;
  }

  .btn-dark.btn-lg img {
    width: 28px;
    height: 28px;
    margin-right: 10px;
    filter: invert(100%) brightness(1.3);
    transition: transform 0.2s ease, filter 0.3s ease;
  }
  .btn-dark.btn-lg:hover img {
    transform: scale(1.15);
    filter: invert(100%) brightness(2.2);
  }
  .progress-inner {
    position: absolute;
    width: 65px;
    height: 65px;
    border-radius: 50%;
    background-color: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    font-weight: 600;
    color: #6c757d;
  }
  #uploadStatus {
    font-size: 1.1rem;
    color: #444;
    font-weight: 500;
    text-align: center;
  }

  /* --- Last Uploaded Text --- */
  #lastUploaded {
    position: fixed;
    top: 28px;
    right: 80px;
    font-size: 0.9rem;
    color: #6c757d;
    font-weight: 500;
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
    opacity: 0.8;
    transition: opacity 0.3s ease, color 0.3s ease;
  }
  #lastUploaded:hover {
    opacity: 1;
    color: #4a6cb3;
  }
</style>

<div class="d-flex flex-column justify-content-center align-items-center text-center vh-100">
  <h1 class="mb-4">Sri Lakshmi Offset Printers</h1>
  <p class="lead mb-5">Making prints as colorful as your life. Since 1973.</p>
  <div class="main-buttons">
    <a href="/select_customer" class="btn btn-dark btn-lg">
      <img src="{{ url_for('static', filename='logos/select_customer.svg') }}" alt="Create New Bill" width="22" height="22" style="margin-right:8px; vertical-align:middle;">
      Create New Bill
    </a>
    <a href="/create_customers" class="btn btn-dark btn-lg">
      <img src="{{ url_for('static', filename='logos/create_customers.svg') }}" alt="Add New Customer" width="22" height="22" style="margin-right:8px; vertical-align:middle;">
      Add New Customer
    </a>
    <a href="/view_bills" class="btn btn-dark btn-lg">
      <img src="{{ url_for('static', filename='logos/view_bills.svg') }}" alt="View Bills" width="22" height="22" style="margin-right:8px; vertical-align:middle;">
      View Bills
    </a>
    <a href="/statements_company" class="btn btn-dark btn-lg text-center">
      <img src="{{ url_for('static', filename='logos/statements_company.svg') }}" alt="Statements" width="22" height="22" style="margin-right:8px; vertical-align:middle;">
      Statements
    </a>
    <a href="/view_customers" class="btn btn-dark btn-lg text-center">
      <img src="{{ url_for('static', filename='logos/view_customers.svg') }}" alt="Customer List" width="22" height="22" style="margin-right:8px; vertical-align:middle;">
      Customer List
    </a>
    <a href="/qr_code" class="btn btn-dark btn-lg text-center">
      <img src="{{ url_for('static', filename='logos/qr_code.svg') }}" alt="Generate UPI QR" width="22" height="22" style="margin-right:8px; vertical-align:middle;">
      Generate UPI QR
    </a>
    <a href="/config" class="btn btn-dark btn-lg text-center">
      <img src="{{ url_for('static', filename='logos/config.svg') }}" alt="Account Settings" width="22" height="22" style="margin-right:8px; vertical-align:middle;">
      Account Settings
    </a>
    <a href="/more" class="btn btn-dark btn-lg">
      <img src="{{ url_for('static', filename='logos/more.svg') }}" alt="More" width="22" height="22" style="margin-right:8px; vertical-align:middle;">
      More
    </a>
  </div>
</div>

<button id="cloudUploadBtn" aria-label="Cloud Upload" title="Cloud Upload">☁️</button>
<span id="lastUploaded">
  Last Sync: {{ last_uploaded or "Never" }}
</span>

{% if session and session.get('persistent_notice') %}
<div class="modal fade" id="persistentNoticeModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Notice</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        {{ session.persistent_notice|safe }}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var noticeModal = new bootstrap.Modal(document.getElementById('persistentNoticeModal'));
    noticeModal.show();
  });
</script>
{% endif %}


<div class="modal fade" id="cloudUploadModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-4 text-center">
      <div class="progress-circle" id="progressCircle">
        <div class="progress-inner" id="progressValue">0%</div>
      </div>
      <p id="uploadStatus" class="mb-0">Waiting to start...</p>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const uploadBtn = document.getElementById('cloudUploadBtn');
    const uploadModal = new bootstrap.Modal(document.getElementById('cloudUploadModal'));
    const progressCircle = document.getElementById('progressCircle');
    const progressValue = document.getElementById('progressValue');
    const statusText = document.getElementById('uploadStatus');

    uploadBtn.addEventListener('click', function(e) {
      e.preventDefault();
      uploadModal.show();
      let progress = 0;
      statusText.textContent = 'Uploading to Cloud...';

      const interval = setInterval(() => {
        progress += 5;
        const degrees = (progress / 100) * 360;
        progressCircle.style.background = `conic-gradient(#6c8edb ${degrees}deg, #cfd8dc ${degrees}deg)`;
        progressValue.textContent = progress + '%';

        if (progress >= 100) {
          clearInterval(interval);
          statusText.textContent = 'Upload Complete!';
          progressValue.textContent = '✓';
          progressCircle.style.background = 'conic-gradient(#6c8edb 360deg, #6c8edb 360deg)';
          progressValue.style.color = '#6c8edb';
        }
      }, 200);
    });

    const lastUpload = document.getElementById("lastUploaded");
    if (lastUpload && lastUpload.textContent.includes(new Date().getFullYear().toString())) {
      lastUpload.style.textShadow = "0 0 8px rgba(108,142,219,0.4)";
      setTimeout(() => {
        lastUpload.style.textShadow = "none";
      }, 5000);
    }
  });
</script>

{% endblock %}