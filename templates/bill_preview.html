<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ invoice.invoiceId }} - Invoice</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }
      .brand-logo {
        height: 60px; /* adjust as needed */
        display: block;
      }
      @media print {
        .brand-logo { height: 48px; }
      }
      .signature-img {
        max-width: 160px; /* reduced size */
        height: auto;
        display: block;
        margin-bottom: 0.25rem;
        user-select: none;
        -webkit-user-drag: none;
      }
      @media print {
        .signature-img { max-width: 140px; }
      }
      .payment-info { font-size: 0.95rem; }
      .signature-wrap {
        display: inline-flex;
        flex-direction: column;
        align-items: center; /* center caption to image width */
      }
      .signature-caption {
        width: 100%;
        text-align: center;
      }
      /* Extra-thin table borders (screen) */
      table.table { border-collapse: collapse; }
      .table-bordered > :not(caption) > * { border-width: 0.5px !important; }
      .table-bordered td, .table-bordered th { border-width: 0.5px !important; }
      .table { border-color: #c8c8c8 !important; }
      /* Print/PDF sizing */
      @page {
        size: A4;
        margin: 16mm;
      }
      @media print {
        body { font-size: 14px !important; line-height: 1.35; }
        .container { max-width: 100% !important; }
        /* Headings scaled between 12–18px range */
        h1 { font-size: 18px !important; }
        h2 { font-size: 18px !important; }
        h3 { font-size: 17px !important; }
        h4 { font-size: 16px !important; }
        h5 { font-size: 15px !important; }
        h6 { font-size: 14px !important; }
        /* Tables and misc text */
        table, .table, .table th, .table td { font-size: 14px !important; }
        .payment-info { font-size: 14px !important; }
        .text-muted { color: #6c757d !important; }
        /* Keep logo and signature tidy for print */
        .brand-logo { height: 42px !important; }
        .signature-img { max-width: 130px !important; }
        /* Ultra-thin table borders (print/PDF) */
        table.table { table-layout: auto !important; width: 100% !important; }
        .table { border-color: #b5b5b5 !important; }
        .table-bordered > :not(caption) > * { border-width: 0.4px !important; }
        .table-bordered td, .table-bordered th { border-width: 0.4px !important; }
        .services small { font-size: 1.1rem !important; font-weight: 700 !important; }
      }
      .bill-heading { text-align: center; margin-top:4px; font-size:20px; font-weight:bold; color:#000; }
      .highlight-info { color:#1a2a6c; }
      .masthead { text-align: left; }
    </style>
</head>
<body class="p-5">

    <div class="container">
        <div class="masthead mb-2">
          <h1 class="visually-hidden">Sri Lakshmi Offset Printers — ESTD: 1973</h1>
          <img class="brand-logo" src="{{ url_for('static', filename='img/brand-wordmark.svg') }}" alt="Sri Lakshmi Offset Printers — ESTD: 1973">
          <h2 class="bill-heading">Bill of Supply</h2>
        </div>

        <div class="row mb-4">
            <div class="col-sm-6">
                <h5>From:</h5>
                <p>
                    <strong>Sri Lakshmi Offset Printers</strong><br>
                PAMARRU, Krishna Dist - 521157<br>
                GST: 37AVEPM5991R3ZG<br>
                Cell: 9848992207<br>
                email: haripress@gmail.com<br>
                </p>
                <small class="text-muted" style="font-size: 0.6rem;">Composition Taxable Person. Not eligible to collect Tax on supplies.</small>
            </div>
            <div class="col-sm-6 text-end">
                <h5>To:</h5>
                <p class="highlight-info">
                    {% if customer.company %}<strong>{{ customer.company }}</strong><br>{% endif %}
                    {% if customer.address %}{{ customer.address }}<br>{% endif %}
                    {% if customer.gst %}GST: {{ customer.gst }}<br>{% endif %}
                    {% if customer.phone %}ID_No: {{ customer.phone }}{% endif %}
                </p>
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-sm-6">
                <p class="highlight-info"><strong>Invoice No:</strong> {{ invoice.invoiceId }}</p>
                <p class="highlight-info"><strong>Date:</strong> {{ invoice.createdAt.strftime('%d-%m-%Y') }}</p>
            </div>
        </div>

        <table class="table table-bordered">
          {% if dcno %}
          <colgroup>
            <col style="width:6%">
            <col style="width:58%">
            <col style="width:16%">
            <col style="width:10%">
            <col style="width:10%">
          </colgroup>
          {% else %}
          <colgroup>
            <col style="width:6%">
            <col style="width:64%">
            <col style="width:15%">
            <col style="width:15%">
          </colgroup>
          {% endif %}
            <thead class="table-light text-center">
                <tr>
                    <th>Serial No</th>
                    <th>Description</th>
                    {% if dcno %}<th>Delivery Challan No</th>{% endif %}
                    <th>Quantity</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td class="text-center">{{ loop.index }}</td>
                    <td class="text-start">{{ item[0] }}</td>
                    {% if dcno %}
                    <td class="text-center">{{ dc_numbers[loop.index0] if dc_numbers is defined and dc_numbers|length > loop.index0 else '' }}</td>
                    {% endif %}
                    <td class="text-center">{{ item[2] }}</td>
                    <td class="text-center"><span class="money" data-amount="{{ item[6] }}"></span></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <div class="text-end">
            <h5>Total: ₹ <strong><span class="money" data-amount="{{ invoice.totalAmount or 0 }}"></span></strong></h5>
            {% if total_in_words %}
            <div class="text-muted" style="font-size: 0.95rem;">Amount in words: <em>{{ total_in_words }}</em></div>
            {% endif %}
        </div>

        <div class="mt-3 text-end">
          <small class="text-muted" style="font-size: 0.7rem;">Computer generated receipt – signature not required</small>
        </div>

        <div class="row mt-5">
          <div class="col-12 payment-info">
            <h6 class="mb-2">Payment Information</h6>
            <div>
              Account Name: <strong>Sri Lakshmi Offset Printers</strong><br>
              Bank: <strong>State Bank of India, Pamarru</strong><br>
              Account Number: <strong>38588014977</strong><br>
              IFSC: <strong>SBIN0002776</strong><br>
              PhonePe/GPay: <strong>9848992207</strong>
            </div>
          </div>
        </div>

        <hr class="my-3" style="border:0;border-top:2px solid #c8c8c8;" />
        <div class="services text-center mt-4">
          <small class="text-muted" style="font-size: 0.80rem; font-weight: 700;">
            Services: Multi‑colour offset printing • Digital printing • Brochures • Stickers • Invitations • Pamphlets • All Printing Works
          </small>
        </div>

        <div class="text-center mt-4 d-print-none">
            <button onclick="window.print()" class="btn btn-primary">Print / Save as PDF</button>
            <p class="mt-2 text-muted" style="font-size: 0.9rem;">Tip: Uncheck “Headers and footers” in print dialog for a clean copy.</p>
        </div>
    </div>

<script>
  (function(){
    function formatINR(n){
      const num = Number(n||0);
      return num.toLocaleString('en-IN', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }
    document.querySelectorAll('.money').forEach(el => {
      const v = el.getAttribute('data-amount');
      el.textContent = formatINR(v);
    });
  })();
</script>

</body>
</html>